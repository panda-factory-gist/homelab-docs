"use strict";(globalThis.webpackChunkhomelab_docs=globalThis.webpackChunkhomelab_docs||[]).push([[1721],{2284:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>u,frontMatter:()=>o,metadata:()=>r,toc:()=>d});var r=s(6073),i=s(4848),l=s(8453);const o={slug:"docker-services-deployment",title:"\ud83d\udc33 D\xe9ploiement de services Docker avec Dockge",authors:"nelia",tags:["docker","nextcloud","monitoring","dockge","containers"],date:new Date("2025-12-02T23:00:00.000Z")},t="\ud83d\udc33 D\xe9ploiement de services Docker - Jour 2",c={authorsImageUrls:[void 0]},d=[{value:"\ud83c\udfaf Objectifs du jour",id:"-objectifs-du-jour",level:2},{value:"\ud83d\udce6 Services d\xe9ploy\xe9s",id:"-services-d\xe9ploy\xe9s",level:2},{value:"1. Dockge (Gestion Docker)",id:"1-dockge-gestion-docker",level:3},{value:"2. Uptime Kuma (Monitoring)",id:"2-uptime-kuma-monitoring",level:3},{value:"3. Nextcloud (Cloud personnel)",id:"3-nextcloud-cloud-personnel",level:3},{value:"\ud83d\udd27 Configuration Cloudflare Tunnel",id:"-configuration-cloudflare-tunnel",level:2},{value:"Mise \xe0 jour du tunnel (Hermes)",id:"mise-\xe0-jour-du-tunnel-hermes",level:3},{value:"\ud83d\udd10 S\xe9curit\xe9",id:"-s\xe9curit\xe9",level:2},{value:"Cloudflare Access (Zero Trust)",id:"cloudflare-access-zero-trust",level:3},{value:"Isolation r\xe9seau",id:"isolation-r\xe9seau",level:3},{value:"\ud83d\udcda Apprentissage Docker",id:"-apprentissage-docker",level:2},{value:"Ce que j&#39;ai appris en pratique",id:"ce-que-jai-appris-en-pratique",level:3},{value:"1. Docker Compose - Structure",id:"1-docker-compose---structure",level:4},{value:"2. Images Docker",id:"2-images-docker",level:4},{value:"3. Ports",id:"3-ports",level:4},{value:"4. Volumes (persistance des donn\xe9es)",id:"4-volumes-persistance-des-donn\xe9es",level:4},{value:"5. Networks (communication inter-containers)",id:"5-networks-communication-inter-containers",level:4},{value:"6. Environment variables",id:"6-environment-variables",level:4},{value:"7. Depends_on (ordre de d\xe9marrage)",id:"7-depends_on-ordre-de-d\xe9marrage",level:4},{value:"8. Restart policies",id:"8-restart-policies",level:4},{value:"\ud83d\udc1b Probl\xe8mes rencontr\xe9s et solutions",id:"-probl\xe8mes-rencontr\xe9s-et-solutions",level:2},{value:"Probl\xe8me 1 : Cache navigateur",id:"probl\xe8me-1--cache-navigateur",level:3},{value:"Probl\xe8me 2 : PostgreSQL sans mot de passe",id:"probl\xe8me-2--postgresql-sans-mot-de-passe",level:3},{value:"Probl\xe8me 3 : Nextcloud ne peut pas joindre &quot;db&quot;",id:"probl\xe8me-3--nextcloud-ne-peut-pas-joindre-db",level:3},{value:"Probl\xe8me 4 : Configuration Nextcloud prot\xe9g\xe9e",id:"probl\xe8me-4--configuration-nextcloud-prot\xe9g\xe9e",level:3},{value:"\ud83d\udcca Architecture finale",id:"-architecture-finale",level:2},{value:"\ud83c\udfaf Prochaines \xe9tapes",id:"-prochaines-\xe9tapes",level:2},{value:"Cette semaine",id:"cette-semaine",level:3},{value:"D\xe9cembre 2025",id:"d\xe9cembre-2025",level:3},{value:"Janvier 2026",id:"janvier-2026",level:3},{value:"\ud83d\udcad R\xe9flexions",id:"-r\xe9flexions",level:2},{value:"L&#39;apprentissage par la pratique",id:"lapprentissage-par-la-pratique",level:3},{value:"Ce que j&#39;ai vraiment appris",id:"ce-que-jai-vraiment-appris",level:3},{value:"Pour les d\xe9butants",id:"pour-les-d\xe9butants",level:3},{value:"\ud83d\udcc8 Statistiques",id:"-statistiques",level:2},{value:"\ud83d\udd17 Ressources",id:"-ressources",level:2}];function a(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"Aujourd'hui, j'ai d\xe9ploy\xe9 mes premiers services en production sur Olympus Lab en utilisant Docker et Dockge. L'objectif : apprendre Docker en pratique, pas en regardant des cours !"}),"\n",(0,i.jsx)(n.h2,{id:"-objectifs-du-jour",children:"\ud83c\udfaf Objectifs du jour"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"D\xe9ployer Dockge pour g\xe9rer les containers Docker"}),"\n",(0,i.jsx)(n.li,{children:"Installer Uptime Kuma pour le monitoring"}),"\n",(0,i.jsx)(n.li,{children:"D\xe9ployer Nextcloud comme cloud personnel"}),"\n",(0,i.jsx)(n.li,{children:"Apprendre Docker Compose en pratique"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-services-d\xe9ploy\xe9s",children:"\ud83d\udce6 Services d\xe9ploy\xe9s"}),"\n",(0,i.jsx)(n.h3,{id:"1-dockge-gestion-docker",children:"1. Dockge (Gestion Docker)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Pourquoi"})," : Interface web pour g\xe9rer les stacks Docker Compose"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Configuration"})," :"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'services:\n  dockge:\n    image: louislam/dockge:latest\n    container_name: dockge\n    restart: unless-stopped\n    ports:\n      - "5001:5001"\n    volumes:\n      - /var/run/docker.sock:/var/run/docker.sock\n      - ./data:/app/data\n      - ./stacks:/opt/stacks\n    environment:\n      - DOCKGE_STACKS_DIR=/opt/stacks\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Acc\xe8s"})," : https: //dockge.[domain].org (prot\xe9g\xe9 par Cloudflare Access)"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Avantages"})," :"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Interface graphique pour d\xe9ployer des stacks"}),"\n",(0,i.jsx)(n.li,{children:"Logs en temps r\xe9el"}),"\n",(0,i.jsx)(n.li,{children:"Start/Stop/Restart en un clic"}),"\n",(0,i.jsx)(n.li,{children:"\xc9dition de docker-compose.yml directement"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"2-uptime-kuma-monitoring",children:"2. Uptime Kuma (Monitoring)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Pourquoi"})," : Surveillance 24/7 de tous les services"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Configuration"})," :"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'services:\n  uptime-kuma:\n    image: louislam/uptime-kuma:latest\n    container_name: uptime-kuma\n    restart: unless-stopped\n    ports:\n      - "3001:3001"\n    volumes:\n      - uptime-kuma:/app/data\n\nvolumes:\n  uptime-kuma:\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Acc\xe8s"})," : https: //uptime.[domain].org"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Services monitor\xe9s"})," :"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Proxmox"}),"\n",(0,i.jsx)(n.li,{children:"OPNsense"}),"\n",(0,i.jsx)(n.li,{children:"Dockge"}),"\n",(0,i.jsx)(n.li,{children:"Nextcloud"}),"\n",(0,i.jsx)(n.li,{children:"Documentation"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Alertes"}),' : Bot Discord "Iris" (\ud83c\udf08) pour notifications en temps r\xe9el']}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"3-nextcloud-cloud-personnel",children:"3. Nextcloud (Cloud personnel)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Pourquoi"})," : Partage de fichiers entre tous mes appareils (PC, laptop, t\xe9l\xe9phone)"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Architecture"})," :"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Nextcloud (application)"}),"\n",(0,i.jsx)(n.li,{children:"PostgreSQL (base de donn\xe9es)"}),"\n",(0,i.jsx)(n.li,{children:"Redis (cache)"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Configuration"})," :"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'services:\n  nextcloud:\n    image: nextcloud:latest\n    container_name: nextcloud\n    restart: unless-stopped\n    ports:\n      - "8083:80"\n    environment:\n      - POSTGRES_HOST=db\n      - POSTGRES_DB=nextcloud\n      - POSTGRES_USER=nextcloud\n      - POSTGRES_PASSWORD=[mot-de-passe-fort]\n      - REDIS_HOST=redis\n      - NEXTCLOUD_TRUSTED_DOMAINS=[domain].org [IP-locale]\n      - TRUSTED_PROXIES=172.16.0.0/12\n      - OVERWRITEPROTOCOL=https\n      - OVERWRITEHOST=[domain].org\n    volumes:\n      - nextcloud_data:/var/www/html\n    depends_on:\n      - db\n      - redis\n    networks:\n      - nextcloud_net\n\n  db:\n    image: postgres:16-alpine\n    container_name: nextcloud-db\n    restart: unless-stopped\n    environment:\n      - POSTGRES_DB=nextcloud\n      - POSTGRES_USER=nextcloud\n      - POSTGRES_PASSWORD=[mot-de-passe-fort]\n    volumes:\n      - db_data:/var/lib/postgresql/data\n    networks:\n      - nextcloud_net\n\n  redis:\n    image: redis:alpine\n    container_name: nextcloud-redis\n    restart: unless-stopped\n    networks:\n      - nextcloud_net\n\nvolumes:\n  nextcloud_data:\n  db_data:\n\nnetworks:\n  nextcloud_net:\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Acc\xe8s"})," : https: //nextcloud.[domain].org"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Fonctionnalit\xe9s"})," :"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Synchronisation automatique (desktop + mobile)"}),"\n",(0,i.jsx)(n.li,{children:"Partage de fichiers"}),"\n",(0,i.jsx)(n.li,{children:"Calendrier & Contacts"}),"\n",(0,i.jsx)(n.li,{children:"Notes collaboratives"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-configuration-cloudflare-tunnel",children:"\ud83d\udd27 Configuration Cloudflare Tunnel"}),"\n",(0,i.jsx)(n.h3,{id:"mise-\xe0-jour-du-tunnel-hermes",children:"Mise \xe0 jour du tunnel (Hermes)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Fichier"})," : ",(0,i.jsx)(n.code,{children:"/etc/cloudflared/config.yml"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"tunnel: [tunnel-id]\ncredentials-file: /etc/cloudflared/[tunnel-id].json\n\ningress:\n  # Services existants\n  - hostname: opnsense.[domain].org\n    service: https: //10.0.1.1\n    originServerName: 10.0.1.1\n    originRequest:\n      noTLSVerify: true\n  \n  - hostname: proxmox.[domain].org\n    service: https://192.168.1.51:8006\n    originRequest:\n      noTLSVerify: true\n  \n  - hostname: ssh-proxmox.[domain].org\n    service: ssh://192.168.1.51:22\n  \n  - hostname: ssh-docker.[domain].org\n    service: ssh://10.0.1.102:22\n  \n  # Nouveaux services Docker\n  - hostname: dockge.[domain].org\n    service: http://10.0.1.102:5001\n  \n  - hostname: uptime.[domain].org\n    service: http://10.0.1.102:3001\n  \n  - hostname: nextcloud.[domain].org\n    service: http://10.0.1.102:8083\n  \n  # Catch-all\n  - service: http_status:404\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Red\xe9marrage"})," :"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"systemctl restart cloudflared\njournalctl -u cloudflared -f\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-s\xe9curit\xe9",children:"\ud83d\udd10 S\xe9curit\xe9"}),"\n",(0,i.jsx)(n.h3,{id:"cloudflare-access-zero-trust",children:"Cloudflare Access (Zero Trust)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Applications configur\xe9es"})," :"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Service"}),(0,i.jsx)(n.th,{children:"URL"}),(0,i.jsx)(n.th,{children:"Policy"}),(0,i.jsx)(n.th,{children:"Session"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Dockge"}),(0,i.jsx)(n.td,{children:"dockge.[domain].org"}),(0,i.jsx)(n.td,{children:"Email + OTP"}),(0,i.jsx)(n.td,{children:"24h"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Uptime Kuma"}),(0,i.jsx)(n.td,{children:"uptime.[domain].org"}),(0,i.jsx)(n.td,{children:"Email + OTP"}),(0,i.jsx)(n.td,{children:"24h"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Nextcloud"}),(0,i.jsx)(n.td,{children:"nextcloud.[domain].org"}),(0,i.jsx)(n.td,{children:"Email + OTP"}),(0,i.jsx)(n.td,{children:"24h"})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Protection multi-couches"})," :"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Cloudflare Edge (DDoS, WAF)"}),"\n",(0,i.jsx)(n.li,{children:"Cloudflare Access (authentification email + OTP)"}),"\n",(0,i.jsx)(n.li,{children:"Cloudflare Tunnel (z\xe9ro port ouvert)"}),"\n",(0,i.jsx)(n.li,{children:"Firewall OPNsense (r\xe8gles granulaires)"}),"\n",(0,i.jsx)(n.li,{children:"Authentification service (login/password)"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"isolation-r\xe9seau",children:"Isolation r\xe9seau"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"VM Docker"})," : R\xe9seau LAN (10.0.1.0/24)"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u2705 Acc\xe8s Internet"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Communication interne LAN"}),"\n",(0,i.jsx)(n.li,{children:"\u274c Pas d'acc\xe8s DMZ, DEV, MGMT"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Containers Docker"})," : R\xe9seau bridge isol\xe9 (172.x.x.x/12)"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Communication entre containers de la m\xeame stack uniquement"}),"\n",(0,i.jsx)(n.li,{children:"Pas d'acc\xe8s direct aux autres containers"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-apprentissage-docker",children:"\ud83d\udcda Apprentissage Docker"}),"\n",(0,i.jsx)(n.h3,{id:"ce-que-jai-appris-en-pratique",children:"Ce que j'ai appris en pratique"}),"\n",(0,i.jsx)(n.h4,{id:"1-docker-compose---structure",children:"1. Docker Compose - Structure"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Services"})," : Liste des containers \xe0 cr\xe9er"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"services:\n  mon-app:\n    image: ...\n    ports: ...\n    volumes: ...\n"})}),"\n",(0,i.jsx)(n.h4,{id:"2-images-docker",children:"2. Images Docker"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"image: nextcloud:latest\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"nextcloud"})," = nom de l'image"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:":latest"})," = tag (version)"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Alternatives"})," :"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:":1.23.11"})," = version sp\xe9cifique (plus stable)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:":alpine"})," = version l\xe9g\xe8re"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"3-ports",children:"3. Ports"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'ports:\n  - "8083:80"\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"8083"})," = port sur la VM (externe)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"80"})," = port dans le container (interne)"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Utilisation"})," : ",(0,i.jsx)(n.code,{children:"http://10.0.1.102:8083"})," pointe vers le port 80 du container"]}),"\n",(0,i.jsx)(n.h4,{id:"4-volumes-persistance-des-donn\xe9es",children:"4. Volumes (persistance des donn\xe9es)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Volumes nomm\xe9s"})," :"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"volumes:\n  - nextcloud_data:/var/www/html\n\nvolumes:\n  nextcloud_data:  # D\xe9claration\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"G\xe9r\xe9 par Docker"}),"\n",(0,i.jsxs)(n.li,{children:["Stock\xe9 dans ",(0,i.jsx)(n.code,{children:"/var/lib/docker/volumes/"})]}),"\n",(0,i.jsx)(n.li,{children:"Persiste m\xeame si container supprim\xe9"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Bind mounts"})," :"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"volumes:\n  - ./data:/app/data\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Dossier local mont\xe9 directement"}),"\n",(0,i.jsx)(n.li,{children:"Fichiers visibles sur la VM"}),"\n",(0,i.jsx)(n.li,{children:"Modifiable \xe0 chaud"}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"5-networks-communication-inter-containers",children:"5. Networks (communication inter-containers)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"networks:\n  - nextcloud_net\n\nnetworks:\n  nextcloud_net:  # D\xe9claration\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Utilit\xe9"})," : Les containers sur le m\xeame network peuvent communiquer par nom"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"nextcloud"})," peut joindre ",(0,i.jsx)(n.code,{children:"db"})," directement"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"POSTGRES_HOST=db"})," fonctionne"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"6-environment-variables",children:"6. Environment variables"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"environment:\n  - POSTGRES_PASSWORD=secure123\n  - POSTGRES_HOST=db\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Configuration sans rebuild"})," : Change le comportement du container"]}),"\n",(0,i.jsx)(n.h4,{id:"7-depends_on-ordre-de-d\xe9marrage",children:"7. Depends_on (ordre de d\xe9marrage)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"depends_on:\n  - db\n  - redis\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Utilit\xe9"})," : Nextcloud d\xe9marre APR\xc8S PostgreSQL et Redis"]}),"\n",(0,i.jsx)(n.h4,{id:"8-restart-policies",children:"8. Restart policies"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"restart: unless-stopped\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Options"})," :"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"no"})," : Ne jamais red\xe9marrer"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"always"})," : Toujours red\xe9marrer (m\xeame si arr\xeat\xe9 manuellement)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"unless-stopped"})," : Red\xe9marrer sauf si arr\xeat\xe9 volontairement"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"on-failure"})," : Red\xe9marrer seulement si erreur"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-probl\xe8mes-rencontr\xe9s-et-solutions",children:"\ud83d\udc1b Probl\xe8mes rencontr\xe9s et solutions"}),"\n",(0,i.jsx)(n.h3,{id:"probl\xe8me-1--cache-navigateur",children:"Probl\xe8me 1 : Cache navigateur"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Sympt\xf4me"}),' : "Unable to find your Access application"\n',(0,i.jsx)(n.strong,{children:"Cause"})," : Cache SSL du navigateur\n",(0,i.jsx)(n.strong,{children:"Solution"})," : Navigation priv\xe9e ou vider le cache (Ctrl+Shift+Delete)"]}),"\n",(0,i.jsx)(n.h3,{id:"probl\xe8me-2--postgresql-sans-mot-de-passe",children:"Probl\xe8me 2 : PostgreSQL sans mot de passe"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Sympt\xf4me"})," : ",(0,i.jsx)(n.code,{children:"POSTGRES_PASSWORD is not specified"}),"\n",(0,i.jsx)(n.strong,{children:"Cause"})," : Variable d'environnement mal format\xe9e\n",(0,i.jsx)(n.strong,{children:"Solution"})," : Utiliser ",(0,i.jsx)(n.code,{children:"- POSTGRES_PASSWORD=xxx"})," (avec le tiret)"]}),"\n",(0,i.jsx)(n.h3,{id:"probl\xe8me-3--nextcloud-ne-peut-pas-joindre-db",children:'Probl\xe8me 3 : Nextcloud ne peut pas joindre "db"'}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Sympt\xf4me"})," : ",(0,i.jsx)(n.code,{children:'could not translate host name "db"'}),"\n",(0,i.jsx)(n.strong,{children:"Cause"})," : Containers pas sur le m\xeame r\xe9seau Docker\n",(0,i.jsx)(n.strong,{children:"Solution"})," : V\xe9rifier la section ",(0,i.jsx)(n.code,{children:"networks"})," dans docker-compose.yml"]}),"\n",(0,i.jsx)(n.h3,{id:"probl\xe8me-4--configuration-nextcloud-prot\xe9g\xe9e",children:"Probl\xe8me 4 : Configuration Nextcloud prot\xe9g\xe9e"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Sympt\xf4me"})," : ",(0,i.jsx)(n.code,{children:"Configuration was not read or initialized correctly"}),"\n",(0,i.jsx)(n.strong,{children:"Cause"})," : Tentative de r\xe9installation avec donn\xe9es existantes\n",(0,i.jsx)(n.strong,{children:"Solution"})," : ",(0,i.jsx)(n.code,{children:"docker compose down -v"})," pour supprimer les volumes"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-architecture-finale",children:"\ud83d\udcca Architecture finale"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Internet\n    \u2193\nCloudflare Edge (DDoS, WAF)\n    \u2193\nCloudflare Access (Email + OTP)\n    \u2193\nCloudflare Tunnel (Hermes CT-202)\n    \u2193\nVM Docker (10.0.1.102)\n    \u2193\n    \u251c\u2500\u2192 Dockge :5001\n    \u251c\u2500\u2192 Uptime Kuma :3001\n    \u2514\u2500\u2192 Nextcloud Stack\n        \u251c\u2500\u2192 nextcloud :80\n        \u251c\u2500\u2192 postgres :5432\n        \u2514\u2500\u2192 redis :6379\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-prochaines-\xe9tapes",children:"\ud83c\udfaf Prochaines \xe9tapes"}),"\n",(0,i.jsx)(n.h3,{id:"cette-semaine",children:"Cette semaine"}),"\n",(0,i.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Installer app Nextcloud sur tous les appareils"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Pr\xe9parer projet Docker Compose pour l'\xe9cole"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Activer 2FA sur OPNsense et Proxmox"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"d\xe9cembre-2025",children:"D\xe9cembre 2025"}),"\n",(0,i.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Python (Automate the Boring Stuff)"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Networking (Practical Networking)"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Utiliser Nextcloud en mobilit\xe9"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"janvier-2026",children:"Janvier 2026"}),"\n",(0,i.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","GitLab CE ou Gitea (h\xe9bergement code)"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Prometheus + Grafana (monitoring avanc\xe9)"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Pi-hole (DNS + blocage pub)"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-r\xe9flexions",children:"\ud83d\udcad R\xe9flexions"}),"\n",(0,i.jsx)(n.h3,{id:"lapprentissage-par-la-pratique",children:"L'apprentissage par la pratique"}),"\n",(0,i.jsxs)(n.p,{children:["J'ai r\xe9alis\xe9 aujourd'hui que ",(0,i.jsx)(n.strong,{children:"je n'aime pas les cours th\xe9oriques"}),", j'aime ",(0,i.jsx)(n.strong,{children:"FAIRE"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Avant"}),' : "Docker c\'est compliqu\xe9, il faut apprendre toutes les commandes"\n',(0,i.jsx)(n.strong,{children:"Maintenant"})," : \"Docker c'est juste un outil, on l'utilise quand on en a besoin\""]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"La diff\xe9rence"})," :"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u274c Cours Udemy : 20h de vid\xe9os th\xe9oriques \u2192 Ennui \u2192 Oubli"}),"\n",(0,i.jsx)(n.li,{children:'\u2705 Projet concret : "Je veux Nextcloud" \u2192 Docker Compose \u2192 D\xe9ploiement \u2192 Apprentissage r\xe9el'}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"ce-que-jai-vraiment-appris",children:"Ce que j'ai vraiment appris"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\ud83d\udc33 ",(0,i.jsx)(n.strong,{children:"Docker Compose"})," : Services, volumes, networks, environment"]}),"\n",(0,i.jsxs)(n.li,{children:["\ud83d\udd27 ",(0,i.jsx)(n.strong,{children:"Debugging"})," : Lire les logs, comprendre les erreurs, tester"]}),"\n",(0,i.jsxs)(n.li,{children:["\ud83c\udf10 ",(0,i.jsx)(n.strong,{children:"Networking"})," : Communication inter-containers, isolation"]}),"\n",(0,i.jsxs)(n.li,{children:["\ud83c\udfaf ",(0,i.jsx)(n.strong,{children:"M\xe9thodologie"})," : D\xe9ployer, casser, r\xe9parer, documenter"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Et tout \xe7a en UNE journ\xe9e"})," parce que j'avais un ",(0,i.jsx)(n.strong,{children:"objectif concret"})," : avoir un cloud perso."]}),"\n",(0,i.jsx)(n.h3,{id:"pour-les-d\xe9butants",children:"Pour les d\xe9butants"}),"\n",(0,i.jsx)(n.p,{children:"Si tu d\xe9butes en Docker :"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Ne regarde PAS 20h de cours"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Choisis UN service"})," que tu veux d\xe9ployer"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Trouve un docker-compose.yml"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"D\xe9ploie-le"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Casse-le"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Comprends pourquoi"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"R\xe9pare-le"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"R\xe9p\xe8te"})}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Tu apprendras ",(0,i.jsx)(n.strong,{children:"10x plus vite"})," qu'en regardant des cours."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-statistiques",children:"\ud83d\udcc8 Statistiques"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Temps investi"})," : ~6 heures"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"D\xe9ploiement Dockge : 30 min"}),"\n",(0,i.jsx)(n.li,{children:"D\xe9ploiement Uptime Kuma : 45 min"}),"\n",(0,i.jsx)(n.li,{children:"Configuration Iris (Discord) : 15 min"}),"\n",(0,i.jsx)(n.li,{children:"D\xe9ploiement Nextcloud : 3h (debug inclus)"}),"\n",(0,i.jsx)(n.li,{children:"Documentation : 1h"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Services d\xe9ploy\xe9s"})," : 3 stacks (6 containers)\n",(0,i.jsx)(n.strong,{children:"Probl\xe8mes r\xe9solus"})," : 4 (cache, PostgreSQL, r\xe9seau, config)\n",(0,i.jsx)(n.strong,{children:"Lignes de YAML \xe9crites"})," : ~150\n",(0,i.jsx)(n.strong,{children:"Caf\xe9 consomm\xe9"})," : Beaucoup \u2615"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-ressources",children:"\ud83d\udd17 Ressources"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Documentation"})," :"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Docker Compose : ",(0,i.jsx)(n.a,{href:"https://docs.docker.com/compose/",children:"https://docs.docker.com/compose/"})]}),"\n",(0,i.jsxs)(n.li,{children:["Nextcloud : ",(0,i.jsx)(n.a,{href:"https://hub.docker.com/_/nextcloud",children:"https://hub.docker.com/_/nextcloud"})]}),"\n",(0,i.jsxs)(n.li,{children:["Dockge : ",(0,i.jsx)(n.a,{href:"https://github.com/louislam/dockge",children:"https://github.com/louislam/dockge"})]}),"\n",(0,i.jsxs)(n.li,{children:["Uptime Kuma : ",(0,i.jsx)(n.a,{href:"https://github.com/louislam/uptime-kuma",children:"https://github.com/louislam/uptime-kuma"})]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Mon infrastructure"})," :"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Documentation : https: //docs.[domain].org"}),"\n",(0,i.jsx)(n.li,{children:"Monitoring : https: //uptime.[domain].org"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Stack"})," : Docker \u2022 Docker Compose \u2022 Dockge \u2022 Nextcloud \u2022 PostgreSQL \u2022 Redis \u2022 Uptime Kuma"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Tags"})," : #Docker #Containers #Nextcloud #Cloud #DevOps #Learning"]})]})}function u(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},6073:e=>{e.exports=JSON.parse('{"permalink":"/blog/docker-services-deployment","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2025/12-02-docker-services-deployment.md","source":"@site/blog/2025/12-02-docker-services-deployment.md","title":"\ud83d\udc33 D\xe9ploiement de services Docker avec Dockge","description":"Aujourd\'hui, j\'ai d\xe9ploy\xe9 mes premiers services en production sur Olympus Lab en utilisant Docker et Dockge. L\'objectif : apprendre Docker en pratique, pas en regardant des cours !","date":"2025-12-02T23:00:00.000Z","tags":[{"inline":true,"label":"docker","permalink":"/blog/tags/docker"},{"inline":true,"label":"nextcloud","permalink":"/blog/tags/nextcloud"},{"inline":true,"label":"monitoring","permalink":"/blog/tags/monitoring"},{"inline":true,"label":"dockge","permalink":"/blog/tags/dockge"},{"inline":true,"label":"containers","permalink":"/blog/tags/containers"}],"readingTime":6.07,"hasTruncateMarker":true,"authors":[{"name":"N\xe9lia","title":"DevOps Student @ ESGI | Alternance ARPEGE","url":"https://github.com/panda-factory-gist","socials":{"github":"https://github.com/panda-factory-gist"},"imageURL":"https://github.com/panda-factory-gist.png","key":"nelia","page":null}],"frontMatter":{"slug":"docker-services-deployment","title":"\ud83d\udc33 D\xe9ploiement de services Docker avec Dockge","authors":"nelia","tags":["docker","nextcloud","monitoring","dockge","containers"],"date":"2025-12-02T23:00:00.000Z"},"unlisted":false,"nextItem":{"title":"\ud83c\udfdb\ufe0f Olympus Lab - Infrastructure compl\xe8te op\xe9rationnelle","permalink":"/blog/olympus-lab-setup"}}')},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>t});var r=s(6540);const i={},l=r.createContext(i);function o(e){const n=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(l.Provider,{value:n},e.children)}}}]);